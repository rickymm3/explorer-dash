

<div class="header">
    <h1 class="title padded-5">$projectName</h1>

    <div class="topbar v-align-mid">
        <btn class="padded-5" icon="plus-square" label="Sheet" @click="createNewSheet()"></btn>
        <span class="dropdown">
            <btn class="padded-5 sheet-names"
                 @click="setCurrentDropDown(currentSheet)"
                 icon="caret-down" :label="currentSheet.name">
            </btn>
            <div class="dropdown-list suggested-names-panel"
                 v-if="currentDropDown==currentSheet"
                 @click="currentSheetUpdate($event)">
                <div v-for="(item, id) in jsonData.sheets"
                     v-html="item.name"
                     :class="currentSheet==item ? 'isSelected' : ''"
                     :data-index="id"></div>
            </div>
        </span>
    </div>
</div>

<div class="sidebar">
    <btn class="btn-sidebar" :class="{ active: view==0 }" @click="changeView(0)" label="Definable<br/>Values"></btn>
    <btn class="btn-sidebar" :class="{ active: view==1 }" @click="changeView(1)" label="Light<br/>Sequence"></btn>
    <btn class="btn-sidebar" :class="{ active: view==2 }" @click="changeView(2)" label="Action<br/>Sequence"></btn>
    <btn class="v-align-top btn-large" :class="[statusSaveButton.toLowerCase(), isBusy ? 'busy' : '']"
         @click="handleSaveButton($event)"
         v-html="statusSaveButton"
         label="Save"></btn>
</div>

<div id="details">
    <view-tab v-if="view==0" class="view definable-values">
        <comp v-for="def in currentSheet.definableValues" v-bind:obj="def"></comp>
    </view-tab>

    <view-tab v-if="view==1" class="view light-sequence">
        <table width="100%">
            <tr>
                <td class="col-1 side-left">
                    <btn icon="plus-square" label="Light" v-on:click="addLight()"></btn>
                    <draggable :list="currentSheet.lightSequence">
                        <light-item v-for="def in currentSheet.lightSequence" v-bind:obj="def">
                        </light-item>
                    </draggable>
                </td>

                <td class="col-2">
                    <div class="panel" v-if=currentLightItem>

                        <div class="padded-3">
                            <btn class="padded-5" icon="trash-o" title="Delete item" @click="removeLight"></btn>
                            <btn class="padded-5" icon="clone" title="Clone item" @click="copyLight(currentLightItem)"></btn>

                            <i class="inline-block padded-3">
                                <i>Name:</i>
                                <input v-model:value="currentLightItem.name">
                            </i>

                            <!-- Names Suggestion DropDown menu -->
                            <span class="dropdown">
                                <btn class="padded-5 action-names"
                                     @click="setCurrentDropDown(currentLightItem)"
                                     icon="caret-down">
                                </btn>
                                <div class="dropdown-list suggested-names-panel"
                                     v-if="currentDropDown==currentLightItem"
                                     @click="useSuggestedName(currentLightItem, $event, currentSheet.actionSequence)">
                                    <div v-for="(item, id) in currentSheet.actionSequence" v-html="item.name" :data-index="id"></div>
                                </div>
                            </span>

                            <btn class="spacer-1" icon="play" label="Play All"></btn>
                        </div>


                        <div class="padded-3 subpanel ring-sequence">
                            <i class="subheader nowrap v-align-mid-kids">
                                <i>Ring Sequence</i>
                                <i class="spacer-1">
                                    <input type="checkbox" v-model:value="currentLightItem.ringSeqLooping"> &nbsp;
                                    <i class="fa fa-refresh v-align-mid" title="Looping"></i>
                                </i>

                                <i class="spacer-1">
                                    <input type="checkbox" v-model:value="currentLightItem.ringSeqHoldLast"> &nbsp;
                                    <i class="fa fa-pause v-align-mid" title="Hold Last"></i>
                                </i>

                                <i class="break">
                                    <btn class="" icon="plus-square" label="Step"></btn>
                                    <btn class="" icon="play"></btn>
                                </i>
                            </i> <br/>

                            <div class="light-comp ring-light">
                                <div class="ring-center">
                                    <i class="bulb n"></i>
                                    <i class="bulb ne"></i>
                                    <i class="bulb e"></i>
                                    <i class="bulb se"></i>
                                    <i class="bulb s"></i>
                                    <i class="bulb sw"></i>
                                    <i class="bulb w"></i>
                                    <i class="bulb nw"></i>
                                </div>
                            </div>
                        </div>

                        <div class="padded-3 subpanel strip-sequence">
                            <i class="subheader nowrap v-align-mid-kids">
                                <i>Strip Sequence</i>
                                <i class="spacer-1">
                                    <input type="checkbox" v-model:value="currentLightItem.stripSeqLooping"> &nbsp;
                                    <i class="fa fa-refresh v-align-mid" title="Looping"></i>
                                </i>

                                <i class="spacer-1">
                                    <input type="checkbox" v-model:value="currentLightItem.stripSeqHoldLast"> &nbsp;
                                    <i class="fa fa-pause v-align-mid" title="Hold Last"></i>
                                </i>

                                <i class="break">
                                    <btn class="" icon="plus-square" label="Step"></btn>
                                    <btn class="" icon="play"></btn>
                                </i>
                            </i> <br/>

                            <div class="light-comp strip-light">
                                <div class="strip-center">
                                    <i class="bulb n"></i>
                                    <i class="bulb ne"></i>
                                    <i class="bulb e"></i>
                                    <i class="bulb se"></i>
                                    <i class="bulb s"></i>
                                    <i class="bulb sw"></i>
                                    <i class="bulb w"></i>
                                    <i class="bulb nw"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </view-tab>

    <view-tab v-if="view==2" class="view action-sequence">
        <table width="100%">
            <tr>
                <td class="col-1 side-left">
                    <btn icon="plus-square" label="Action" v-on:click="addAction()"></btn>
                    <draggable :list="currentSheet.actionSequence">
                        <action-item v-for="def in currentSheet.actionSequence" v-bind:obj="def">
                        </action-item>
                    </draggable>
                </td>

                <td class="col-2">
                    <div class="panel" v-if=currentActionItem>
                        <div class="padded-3">
                            <btn class="padded-5" icon="trash-o" title="Delete item" @click="removeAction(def)"></btn>
                            <btn class="padded-5" icon="clone" title="Clone item" @click="copyAction(currentActionItem)"></btn>

                            <i class="inline-block padded-3">
                                <i>Name:</i>
                                <input class="" v-model:value="currentActionItem.name">
                            </i>
                            <!-- Names Suggestion DropDown menu -->
                            <span class="dropdown">
                                <btn class="padded-5 action-names"
                                     @click="setCurrentDropDown(currentActionItem)"
                                     icon="caret-down">
                                </btn>
                                <div class="dropdown-list suggested-names-panel"
                                     v-if="currentDropDown==currentActionItem"
                                     @click="useSuggestedName(currentActionItem, $event, currentSheet.lightSequence)">
                                    <div v-for="(item, id) in currentSheet.lightSequence" v-html="item.name" :data-index="id"></div>
                                </div>
                            </span>

                            <btn class="padded-5" icon="plus-square" title="Add an Action Parameter" label="Param" v-on:click="addActionParam()"></btn>
                        </div>

                        <i class="padded-3">
                            <i>Params Count:</i> <i v-html="currentActionItem.params.length"></i>
                        </i>

                        <draggable class="padded-3 strip-action"
                                   :list="currentActionItem.actions"
                                    :options="{ handle: '.drag-handle' }">
                            <div class="border padded-5 action-param"
                                 v-for="actionParam in currentActionItem.params">

                                <div class="inline-block">
                                    <span class="">
                                        <btn class="padded-5" icon="trash-o" title="Delete param" @click="removeActionParam(actionParam)"></btn>
                                        <btn class="padded-5" icon="clone" title="Clone param" @click="copyActionParam(actionParam)"></btn>
                                        <btn class="padded-5 drag-handle" icon="sort" title="Sort param"></btn>

                                        <!-- "Take Off" DropDown menu -->
                                        <span class="dropdown">
                                            <btn class="padded-5 ara-command"
                                                 @click="setCurrentDropDown(actionParam)"
                                                 :label="actionParam.type"><!-- icon="caret-down" -->
                                            </btn>
                                            <div class="dropdown-list ara-command-panel"
                                                 v-if="currentDropDown==actionParam"
                                                 @click="selectActionType(actionParam, $event)">
                                                <div v-for="(araCmd, araID) in hardcoded.AraCommands"
                                                     v-html="araCmd.name"
                                                     :class="actionParam.type==araCmd.name ? 'isSelected' : ''"
                                                     :data-index="araID"></div>
                                            </div>
                                        </span>
                                    </span>

                                    <div class="nowrap head">
                                        <span class="nowrap action-header">
                                            <i>Time:</i>
                                            <input class="digits-3" v-model:value="actionParam.time">
                                        </span>
                                        
                                        <br/>
                                        
                                        <span class="nowrap action-header">
                                            <i>Elevation:</i>
                                            <input class="digits-3" v-model:value="actionParam.elevation">
                                        </span>
                                    </div>
                                </div>

                                
                                <br/>
                                <i class="spacer-1 nowrap">
                                <input type="checkbox" v-model:value="actionParam.waitForRing">
                                <i>Wait For Ring</i>
                                </i>

                                <i class="spacer-1 nowrap">
                                <input type="checkbox" v-model:value="actionParam.waitForStrip">
                                <i>Wait For Strip</i>
                                </i>

                                <i class="spacer-1 nowrap">
                                <input type="checkbox" v-model:value="actionParam.waitForYaw">
                                <i>Wait For Yaw</i>
                                </i>
                            </div>
                        </draggable>

                    </div>
                </td>
            </tr>
        </table>
        
    </view-tab>
</div>

